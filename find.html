<!DOCTYPE html>
<html>
  <head>
    <title>Find similar diode</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link rel="shortcut icon" href="icon.png" type="image/png" />

    <script type="text/javascript" src="canvas.js"></script>
    <script type="text/javascript" src="chart_xyxy.js"></script>
    <script type="text/javascript" src="engineering.js"></script>
    <script type="text/javascript" src="models.js"></script>
    <script type="text/javascript" src="csv/all.js"></script>

    <script type="text/javascript" src="find.js"></script>

    <style>
    body {
        font-family: sans-serif;
        display: flex;
        width: 100%;
        height: 100vh;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    #values {
        _outline: 1px solid red;
        display: flex;
        flex-direction: column;
        width: 20ex;
    }
    #values p {
        font-size: small;
        margin: 0;
    }
    #values textarea {
        flex: 1;
        min-width: 10em;
        resize: none;
    }

    #chart {
        _outline: 1px solid green;
        flex: 1;
        display: flex;
        flex-direction: column;
    }
    #chart_controls {
        _position: fixed;
        display: flex;
    }
    #chart canvas {
        _border: 3px solid cyan;
        box-sizing: border-box;
        width: 100%;
        height: 100%;
        _flex: 1;
    }
    #zoom_to_fit {
        user-select: none;
        _position: absolute;
        _left: 35vw;
        _top: 1ex;
        cursor: pointer;
    }

    #diodes {
        _outline: 1px solid blue;
    }
    #diodes label {
        user-select: none;
        display: block;
    }
    </style>

    <!--
    h3 {
        margin: 0;
        padding: 0;
    }
    label {
        display: inline-block;
        min-width: 4em;
    }
    input[type=number] {
        max-width: 18ex;
        min-width: 18ex;
    }
    table, tr, td, th {
        border: 1px solid black;
        border-collapse: collapse;
    }
    td {
        min-width: 3ex;
        text-align: right;
        max-width: 3em;
        overflow: hidden;
    }
    #chart1 {
      width: 100%;
      height: 80vw;
    }
    @media only screen and (min-width: 800px) {
      #chart {
        display: inline-block;
      }
      #chart table {
        max-widthg: 50vw;
      }
      #chart1 {
          width: 45vw;
          height: 45vw;
      }
      main {
        max-width: 50vw;
        position: fixed;
        left: 50vw;
        top: 1ex;
      }
    }
    </style>
    -->
  </head>
  <body>

    <div id="values">
        <p><a href="how_to_measure_diode.png">Measure</a> diode and paste here content of a CSV file
        with forward voltage in volts and forward current in amps
        (e.g. 2.7mA is 0.0027 or 2.7e-3), comma separated values, each measurement on new line.
        At least 30 values are recommended. Then click on "Similar" button.
        You can publish your measurements on <a href="https://github.com/dvhx/spice-diode-model-js">github</a>.</p>

        <textarea id="measured_values" placeholder="Paste CSV file here" spellcheck="false">0.28,9.361e-7
0.2962,0.000001281
0.3124,0.000001848
0.3286,0.000002676
0.3448,0.000003919
0.361,0.000005848
0.3772,0.000008777
0.3934,0.00001298
0.4097,0.00001938
0.4259,0.00002923
0.4421,0.00004149
0.4583,0.00005986
0.4745,0.00008601
0.4907,0.0001249
0.5069,0.0001735
0.5231,0.0002442
0.5393,0.0003353
0.5555,0.0004649
0.5717,0.0006407
0.5879,0.0008844
0.6041,0.001222
0.6203,0.001707
0.6366,0.002315
0.6528,0.003197
0.669,0.004447
0.6852,0.006108
0.7014,0.008608
0.7176,0.01214
0.7338,0.01659
0.75,0.0229</textarea>
    <button id="clear">Clear</button>
    </div>

    <div id="chart">
        <div id="chart_controls">
            <span id="zoom_to_fit" title="Zoom to fit curves into chart">ðŸ”Ž</span>
            <label style="user-select: none;"><input id="logy" type="checkbox">Logarithmic</label>
            <div style="flex: 1;"></div>
            <button id="check_all" title="Check all diodes">All</button>
            <button id="check_none" title="Uncheck all diodes">None</button>
            <button id="check_similar" title="Check 3 most similar diodes diodes">Similar</button>
        </div>
        <div style="position: relative; width: 100%; height: 100%; flex: 1;">
        <canvas id="chart1" style="position: absolute;"></canvas>
        </div>
    </div>

    <div id="diodes">
        <label style="color: red;"><input id="unknown" type="checkbox" checked>unknown</label>
    </div>

    <!-- div id="chart" style="outline: 0px solid red;">
        <canvas id="chart1" style=""></canvas>

        <div style="display: flex; align-items: center;">
            <label style="user-select: none;"><input id="logy" type="checkbox">Logarithmic</label>
            <div style="flex: 1;"></div>
            <div>
                <span style="color: red;">&mdash;</span> real diode,
                <span style="color: green;">&mdash;</span> model
            </div>
        </div>

        <br>
        Difference: <span id="diff_total">0</span>
        <table id="diff" style="font-size: small;">
            <tr id="diff_u">
                <th>U/mV</th>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
            </tr>
            <tr id="diff_i_real">
                <th>I<sub>real</sub>/mA</th>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
            </tr>
            <tr id="diff_i_model">
                <th>I<sub>model</sub>/mA</th>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
            </tr>
            <tr id="diff_percent">
                <th>Î”/%</th>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
            </tr>
        </table>
        <br>
        Optimize model
        <label title="Optimize model to have lowest average difference"><input id="optimize_for_avg" name="optimize_for" type="radio" checked>average</label>
        <label title="Optimize model to have lowest maximal difference"><input id="optimize_for_max" name="optimize_for" type="radio">max</label>
        <button id="start_monte_carlo">Start</button>
        <button id="stop_monte_carlo" disabled>Stop</button>
    </div>

    <main>

        <h3>Settings</h3>

        <p>
        <label>Temperature</label>
        <input id="temperature" type="number" value="25" min="-273" max="150" step="1" dataWheelStep="1"/>Â°C
        </p>


        <h3 style="color: red;">Real diode</h3>

        <p>
        Paste CSV file with forward voltage in volts and forward current in amps (e.g. 2.7mA is 0.0027 or 2.7e-3), comma separated values, each measurement on new line.
        You can also use one of these real measured diodes:
        <select id="preset_real"></select>
        <a href="how_to_measure_diode.png">How to measure diode</a>
        <br>
        <br>

        <textarea id="measured_values" style="width: 18em; height: 22em; display: block;" placeholder="Paste CSV file here"></textarea>
        </p>


        <h3 style="color: green;">Diode model</h3>

        <p>

        <label>IS</label>
        <input title="" id="IS" type="number" value="1.46464e-9" min="0" max="10" step="0.000000000001" dataWheelStep="0.05"/>A - Reverse saturation current
        <br>

        <label>N</label>
        <input title="" id="N" type="number" value="1.71972" min="0" max="10" step="0.01" dataWheelStep="0.005"/> Emission coefficient
        <br>

        <label>RS</label>
        <input title="" id="RS" type="number" value="0.355592" min="0" max="1000" step="0.01" dataWheelStep="0.1"/>Î© - Ohmic (series) resistance
        <br>

        <label>Preset</label>
        <select id="preset_model">
            <option selected></option>
        </select>
        </p>

        <p style="font-size: small;">
        <b>Spice code:</b> <span id="spice"></span><br><br>

        <b>JS code:</b> <span id="js_code"></span> <span id="js_diff"></span><br>
        </p>

    </main -->

  </body>
</html>



